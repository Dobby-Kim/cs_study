# 9. TCP 3-way-handshake

- TCP는 데이터를 정확하게 주고받기 위해 연결 기반 통신 방식을 사용
- 이 연결을 시작하기 전에 **3-way-handshake**과정을 통해 양쪽(클라이언트와 서버) 모두 연결을 준비하고 서로의 상태를 확인.

## 핵심 키워드와 중요 개념
- 초기 순서 번호(ISN):
    - 각 연결마다 데이터를 순서대로 관리하기 위해 사용하는 임의의 숫자
    - 클라이언트와 서버가 서로의 ISN을 교환하여 이후 데이터의 순서를 보장합니다.

- SYN 플래그:
    - 연결을 설정하는 요청 메시지임을 나타냄
    - 패킷 헤더에 이 플래그가 설정되어 있으면 해당 패킷은 연결 요청임을 의미.

- ACK 플래그:
    - 받은 데이터를 확인했다는 응답 메시지임을 나타냄.
    - 번호를 증가시켜서 “내가 이 번호까지 받았습니다”라고 알려줌.

- 핸드셰이크:
    - 양측이 서로의 준비 상태를 확인하는 과정
    - 이 과정을 통해 신뢰성 있는 통신이 가능.


## 단계별 절차

1. SYN (Synchronize) 전송: 클라이언트 → 서버
    - 클라이언트는 임의의 숫자를 초기 순서 번호(Initial Sequence Number, ISN)로 설정하고, 이 번호를 포함한 패킷을 전송.
    - 이 패킷의 TCP 헤더에는 `SYN` 플래그가 설정되어 있다.
    - "서버님, 저 연결 ㄱㄱ! 내 첫 번째 번호는 100임요."

2. SYN-ACK (Synchronize-Acknowledgment) 응답 – 서버 → 클라이언트
    - 서버는 클라이언트가 보낸 ISN(예: 100)을 확인하고, 그 다음 번호(예: 101)를 ACK(인증) 번호로 전송.
    - 동시에, 서버도 자신의 초기 순서 번호(예: 300)를 정하고, 이를 포함하여 `SYN` 플래그와 `ACK` 플래그가 모두 설정된 패킷을 클라이언트에게 전송.
    - ㅇㅋ, 연결ㄱㄱ. 내가 받은 니 번호는 100이고, 내 번호는 300임요. 다음 번호는 301로 보내셈

3. **ACK (Acknowledgment) 전송 – 클라이언트 → 서버**
    - 클라이언트는 서버가 보낸 ISN(예: 300)을 확인하고, 이를 ACK 번호로 받음. 클라이언트는 서버가 보낸 번호에 1을 더한 값을 ACK 번호로 전송.
    - 이로써 양측은 서로의 초기 순서 번호를 교환하고, 데이터 전송을 위한 연결이 확정.
    - 넹 내가 받은 번호는 300이고, 301로 ACK 보내드림요."

