# 10. TCP vs UDP

## TCP와 UDP

인터넷과 로컬 네트워크에서 데이터를 주고받는 데 사용되는 대표적인 전송 프로토콜에는 TCP와 UDP가 있다.

---

## 들어가기 전에.. 네트워크 기본 개념

### OSI 7 계층 모델과 TCP/IP 모델

네트워크 통신은 여러 계층으로 이루어진 모델을 통해 이해할 수 있다. 가장 널리 알려진 모델은 **OSI 7 계층 모델**과 **TCP/IP 모델**이다.
- **OSI 7 계층 모델**
    1. **물리 계층 (Physical Layer):** 전기 신호, 광신호 등 실제 전송 매체와 관련됨
    2. **데이터 링크 계층 (Data Link Layer):** 프레임 단위의 데이터 전송 및 에러 검출
    3. **네트워크 계층 (Network Layer):** 패킷의 라우팅과 IP 주소 체계
    4. **전송 계층 (Transport Layer):** 종단 간 데이터 전송, 신뢰성, 오류 제어 (TCP, UDP가 여기에 해당)
    5. **세션 계층 (Session Layer):** 연결 관리 및 세션 제어
    6. **표현 계층 (Presentation Layer):** 데이터 형식, 암호화, 압축
    7. **응용 계층 (Application Layer):** 최종 사용자 응용 서비스 (HTTP, FTP, SMTP 등)

- **TCP/IP 모델**은 OSI 모델보다 간략하게 네 계층(네트워크 인터페이스, 인터넷, 전송, 응용)으로 나누며, **전송 계층**에서 TCP와 UDP가 동작한다다.


### 소켓과 IP 주소

- **소켓(Socket):** 네트워크를 통한 데이터 전송의 끝점을 의미하며, IP 주소와 포트 번호의 조합으로 구성됨. 소켓을 통해 애플리케이션은 데이터를 송수신할 수 있다.

- **IP 주소:** 네트워크 상의 장치들을 식별하는 고유 주소로, 데이터가 올바른 목적지에 도달하도록 라우팅하는 역할을 한다.


---

## TCP (Transmission Control Protocol)

### 특징
- **연결 지향(Connection-Oriented):**
    TCP는 데이터를 전송하기 전에 **3-way-handshake**와 같은 연결 설정 과정을 거쳐 클라이언트와 서버 사이에 안정적인 연결을 수립.

- **신뢰성 있는 데이터 전송:**
    데이터가 전송되는 동안 패킷이 손실되거나 순서가 뒤바뀌는 상황이 발생할 수 있다.
    TCP는
    - **재전송**(lost packets retransmission)
    - **순서 보장**(in-order delivery)
    - **오류 검출 및 수정**(error checking) 메커니즘
    을 사용하여 데이터가 정확하게 도착하도록 한다.

- **흐름 제어(Flow Control)와 혼잡 제어(Congestion Control):**
    송신자와 수신자 간의 처리 속도를 맞추어 데이터가 버퍼를 초과하지 않도록 조절하고, 네트워크 전체의 혼잡 상태를 고려해 전송 속도를 동적으로 조절.

- **바이트 스트림(Byte Stream):**
    TCP는 데이터를 바이트의 연속적인 스트림으로 전달
    -> 따라서 전송된 데이터의 경계가 명확하지 않으며
    -> 애플리케이션에서 적절히 데이터를 분리하거나 패킷을 재구성할 필요가 있다.


### 사용 사례
- **웹 브라우징(HTTP, HTTPS):** 안정적인 데이터 전송이 필수
- **파일 전송(FTP):** 파일의 무결성을 보장
- **이메일(SMTP, IMAP):** 데이터 손실 없이 전송되어야 하는 경우

---

## UDP (User Datagram Protocol)

### 기본 특징
- **비연결형(Connectionless):**
    - UDP는 TCP처럼 연결을 설정하는 과정 없이 **데이터그램**(Datagram) 단위로 데이터를 전송
    -  전송 전에 3-way-handshake와 같은 절차가 없기 때문에 오버헤드가 적다.

- **신뢰성 보장이 없음:**
    UDP는 데이터의 도착 여부, 순서, 무결성을 보장하지 않는다.
    - 패킷이 손실되거나 순서가 뒤바뀌어도 별도의 재전송 메커니즘이 없음
    - 애플리케이션이 직접 처리.

- **낮은 지연 시간(Low Latency):**
    연결 설정 및 흐름 제어 등의 과정이 없기 때문에 데이터 전송 속도가 빠르고, 실시간 응용 분야에서 유리.

- **메시지 단위(Message-Oriented):**
    각 데이터그램은 개별적인 메시지 단위로 처리되며, 수신측에서 보낸 메시지의 경계를 인식할 수 있다.


### 사용 사례

- **스트리밍(비디오, 오디오):** 일부 패킷 손실이 허용되는 대신 빠른 전송이 요구됨
- **온라인 게임:** 실시간 상호작용이 중요하여 지연 시간을 최소화해야 함
- **VoIP (Voice over IP):** 통신 지연을 줄이기 위해 사용됨
- **DNS 조회:** 간단하고 빠른 요청-응답 구조


---

## TCP와 UDP의 주요 차이점

| 특징        | TCP                                    | UDP                                  |
| --------- | -------------------------------------- | ------------------------------------ |
| **연결 방식** | 연결 지향 (3-way-handshake 등으로 연결 설정)      | 비연결형 (사전 연결 설정 없이 데이터그램 전송)          |
| **신뢰성**   | 신뢰성 보장 (재전송, 순서 보장, 오류 체크)             | 신뢰성 없음 (데이터 손실, 순서 뒤바뀜 발생 가능)        |
| **전송 단위** | 바이트 스트림                                | 개별 메시지(데이터그램)                        |
| **오버헤드**  | 상대적으로 높음 (연결 설정, 흐름 제어, 혼잡 제어 등 추가 과정) | 낮음 (최소한의 헤더 정보만 포함)                  |
| **사용 용도** | 웹, 파일 전송, 이메일 등 데이터 무결성이 중요한 서비스       | 스트리밍, 게임, VoIP, DNS 등 빠른 전송이 중요한 서비스 |

---

## 네트워크 설계에서의 선택 기준

### 신뢰성 vs. 속도

- **신뢰성이 중요한 경우:** 파일 전송, 웹 페이지 로딩, 데이터베이스 연동 등
    → TCP를 사용하여 데이터의 완전성, 순서, 오류 보정을 보장함.

- **실시간성과 낮은 지연이 중요한 경우:** 실시간 스트리밍, 온라인 게임, 음성/영상 통화 등
    → UDP를 사용하여 빠른 전송을 우선시하고, 일부 패킷 손실을 감내함.


### 애플리케이션 요구 사항

- **데이터 크기와 빈도:**
    TCP는 긴 연결을 통해 연속적인 데이터 흐름에 적합하지만, 초기 연결 설정에 따른 오버헤드가 있다.
    UDP는 짧고 빈번한 메시지 전송에 유리.

- **에러 처리 전략:**
    TCP는 프로토콜 자체에서 재전송과 오류 수정을 제공하므로, 애플리케이션에서 별도의 오류 처리 로직을 구현할 필요가 적다.
    UDP의 경우, 애플리케이션 수준에서 손실된 데이터에 대해 재전송이나 보완 메커니즘을 구현해야 함.


---

## 정리

- **TCP**
	- 연결 지향
	- 신뢰성 보장,
	- 데이터의 순서와 무결성을 유지
	- 웹, 파일 전송, 이메일 등 데이터의 정확한 전달이 중요한 응용 분야에 적합.

- **UDP**
	- 비연결형
	- 낮은 오버헤드
	- 빠른 전송
	- 실시간 스트리밍, 온라인 게임, VoIP, DNS 등 빠른 응답과 낮은 지연이 필수적인 경우에 주로 사용
